(function(e,t){"use strict";var n=t.selection;var i=t.getSelection;var o=i||n;var r=function(e){var t=Object.prototype.toString.call(e);return typeof e==="object"&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(t)&&e.hasOwnProperty("length")&&(e.length===0||typeof e[0]==="object"&&e[0].nodeType>0)};var c=function(e,t){var n;return function(){var i=this,o=arguments;var r=function(){n=null;e.apply(i,o)};clearTimeout(n);n=setTimeout(r,t)}};var s=function(t,n){this.element=t;this.callback=n||function(){};this.isTouch="ontouchstart"in e;this.hasLib=e.jQuery&&t instanceof e.jQuery||e.Zepto&&t instanceof e.Zepto};s.prototype={events:function(){var e=this.callback;var t=this.getText;this[this.isTouch?"bindTouch":"bindMouseUp"](function(){e(t())})},getText:function(){var n="";if(i){n=e.getSelection().toString()}else if(t.selection&&t.selection.type!=="Control"){n=t.selection.createRange().text}return n},checkForSelections:function(e,t,n){var i;var o=function(e){var n=t();var i=setInterval(function(){if(t()!==n){e(t());n=t()}else if(t()===""){clearInterval(i)}},100)};var r=function(){e.removeEventListener("touchend",c,false);e.addEventListener("touchend",c,false);if(i){clearInterval(i)}i=setInterval(function(){var e=t();if(e!==""){n(e);c();o(n)}},100)};var c=function(){clearInterval(i);e.removeEventListener("touchend",c,false)};e.addEventListener("touchstart",r,false)},bindTouch:function(e){var t=this.checkForSelections;var n=this.getText;if(this.hasLib){this.element.each(function(){t(this,n,e)});return}var i=function(i){t(i,n,e)};if(!r(this.element)){i(this.element);return}[].forEach.call(this.element,function(e){i(e)})},bindMouseUp:function(e){if(this.hasLib){this.element.on("mouseup",c(e,150));return}var t=function(t){t.addEventListener("mouseup",c(e,150),false)};if(!r(this.element)){t(this.element);return}[].forEach.call(this.element,function(e){t(e)})}};e.selecting=function(e,t){if(!o){return}new s(e,t).events()}})(window,document);